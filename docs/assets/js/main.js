"use strict";const searchText=document.querySelector(".js-searchtext"),searchBtn=document.querySelector(".js-searchbtn"),animeList=document.querySelector(".js-animelist"),favorites=document.querySelector(".js-favorites"),favsInLocal=document.querySelector(".js-favsinlocal"),resetFavs=document.querySelector(".js-resetfavs");let allResults=[],favoriteAnimes=[],favoritesInLocal=[];function handleSearchBtn(e){e.preventDefault(),searchText.value.length>=3&&fetch("https://api.jikan.moe/v3/search/anime?q="+searchText.value.toLowerCase()).then(e=>e.json()).then(e=>{allResults=e.results,getEachResult()})}function getHtmlAnimeList(e,t,s,a){let n=`<li class="js-anime" id="${e}">`;return n+="https://cdn.myanimelist.net/images/qm_50.gif?s=e1ff92a46db617cb83bfc1e205aff620"===t?`<img src="${a}" alt="${s}">`:`<img src="${t}" alt="${s}">`,n+=`<h2 class="js-animetitle animetitle">${s}</h2>`,n+="</li>",n}function getEachResult(){animeList.innerHTML="";for(let e of allResults){const t="https://via.placeholder.com/210x295/567891/891234/?text="+e.type,s=getHtmlAnimeList(e.mal_id,e.image_url,e.title,t);animeList.innerHTML+=s,getEachAnimeResult()}}function getHtmlFavList(e,t,s){let a=`<li class="js-favorite" id="${e}">`;return a+=`<img src="${t}" alt="${s}">`,a+=`<h2 class="js-animetitle animetitle">${s}</h2>`,a+='<button class="js-deletebtn deletebtn">X</button>',a+="</li>",a}function getFavorite(e){let t=e.currentTarget;const s=getHtmlFavList(t.id,t.childNodes[0].currentSrc,t.childNodes[1].innerHTML);if("darkseagreen"===t.style.backgroundColor)favoriteAnimes.push(s);else{const e=favoriteAnimes.indexOf(s);favoriteAnimes.splice(e,1)}favorites.innerHTML=favoriteAnimes,""!==favorites.innerHTML&&resetFavs.classList.remove("hidden"),localStorage.setItem("favs",JSON.stringify(favoriteAnimes)),getEachDeleteBtn(),getDeleteBtn()}function getEachAnimeResult(){const e=document.querySelectorAll(".js-anime");for(let t of e)t.style.backgroundColor="darkslategray",t.style.color="darkseagreen",t.style.border="10px solid darkslategray",t.addEventListener("click",handleFavoritesColour),t.addEventListener("click",getFavorite)}function handleFavoritesColour(e){let t=e.currentTarget;"darkslategray"===t.style.backgroundColor?(t.style.backgroundColor="darkseagreen",t.style.border="10px solid darkseagreen",t.style.color="darkslategray"):(t.style.backgroundColor="darkslategray",t.style.border="10px solid darkslategray",t.style.color="darkseagreen")}function deleteFavAnime(e){let t=e.currentTarget;console.log(t.parentNode)}function getEachDeleteBtn(){const e=document.querySelectorAll(".js-deletebtn");for(const t of e)t.addEventListener("click",deleteFavAnime)}function getDeleteBtn(){const e=document.querySelectorAll(".js-favorite");for(let s of e){function t(){s.innerHTML=""}s.addEventListener("click",t)}}const savedFavs=JSON.parse(localStorage.getItem("favs"));function handleResetFavorites(){favsInLocal.innerHTML="",favorites.innerHTML="",resetFavs.classList.add("hidden")}favoritesInLocal=savedFavs,favsInLocal.innerHTML=favoritesInLocal,""!==favsInLocal.innerHTML&&resetFavs.classList.remove("hidden"),resetFavs.addEventListener("click",handleResetFavorites),searchBtn.addEventListener("click",handleSearchBtn);